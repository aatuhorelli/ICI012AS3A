# H4 - Kääntöpaikka

Tehtävänannot luettavissa https://terokarvinen.com/application-hacking/

## X) Lue/katso ja tiivistä

### John Hammond - GHIDRA for Reverse Engineering (PicoCTF 2022 #42 'bbbloat')

Videolla Hammond ratkaisee PicoCTF:n tehtävän Bbbbloat.

 - Ennen Ghidran käyttöä voi kokeilla ``$ ltrace``, ``$ strace``, ``$ objdump -d``, ``$ file``
   - Debuggerin tapaisia ohjelmia
   - ltrace seuraa ajonaikaisia kirjastojen kutsuja
   - strace seuraa systeemikutsuja
 - Ghidran asennus:
   - Lataus Githubista
   - Purku (``$ unzip [tiedosto]``)
   - Tarvittaessa javan asennus 
 - Ghidran käyttö:
   - Luo uusi projekti
   - Lisää analysoitava binääri projektille
   - Analyze? -> yes
 - Videolla hyödynnettyjä Ghidran ominaisuuksia:
   - Window -> defined strings: etsii merkkijonoja
   - L: rename (pikanäppäin)
 - Assembler:
   - XREF: Cross-reference. Viittaus muuttujaan tai funktioon
   - FUN: funktio
   - LEA: Load effective address

Hammond tulkitsee ohjelman lähdekoodista, mihin arvoon käyttäjän syötettä verrataan. Arvo on koodissa heksadesimaaliarvona, jonka desimaaliksi muuttamalla ja syöttämällä tehtävään lippu paljastuu. 

Lähde: https://www.youtube.com/watch?v=oTD_ki86c9I


## A) Ghidran asennus

Asensin Ghidran jo edellisellä tunnilla, mistä johtuen prosessi kirjoitettu pitkälti ulkomuistista.

Vaiheet:
 - Latasin GitHubista Ghidran tuoreimman julkaisun: ``$ wget https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_11.2.1_build/ghidra_11.2.1_PUBLIC_20241105.zip``
 - Purin .zip-tiedoston: ``$ unzip ghidra_11.2.1_PUBLIC_20241105.zip``
 - Siirryin paketin purkamisesta luotuun hakemistoon ja ajoin Ghidran: ``$ ./ghidraRun``
   - Käynnistäminen epäonnistui Java-version yhteensopimattomuuden takia.
   - Asensin tuoreemmat versiot Javasta ``$ sudo apt-get install default-jre default-jdk``
 - Tämän jälkeen Ghidran käynnistys onnistui komennolla ``$ ./ghidraRun``

## B) Rever-C

Loin Ghidraan uuden projektin
Pakattu, vaikeaselkoinen

````
undefined8 FUN_001054d0(void)

{
  int iVar1;
  undefined local_28 [32];
  
  FUN_001053a7(0x10637f);
  FUN_001053c7(0x106394,local_28);
  iVar1 = FUN_001053b7(local_28,0x106399);
  if (iVar1 == 0) {
    FUN_001053a7(0x1063a7);
  }
  else {
    FUN_001053a7(0x1063ed);
  }
  return 0;
}
````
> Vaikeaselkoista on pakatulla binäärilllä

UPX purkaminen

````
undefined8 main(void)

{
  int iVar1;
  char local_28 [32];
  
  puts("What\'s the password?");
  __isoc99_scanf(&DAT_0010201d,local_28);
  iVar1 = strcmp(local_28,"piilos-AnAnAs");
  if (iVar1 == 0) {
    puts("Yes! That\'s the password. FLAG{Tero-0e3bed0a89d8851da933c64fefad4ff2}");
  }
  else {
    puts("Sorry, no bonus.");
  }
  return 0;
}
````
> Näyttää paremmalta



## C) Jos väärinpäin

## D) Nora CrackMe

## E) Nora crackme01

## E) Nora crackme01e

## F) Nora crackme02

## G) Vapaaehtoinen: Nora crackme01 muut ratkaisut

## H) Vapaaehtoinen: Nora crackme02 toinen ratkaisu

## I) Vapaaehtoinen: Nora crackme02e 



## Lähteet

Karvinen 2024: Application Hacking. Luettavissa https://terokarvinen.com/application-hacking/. 

John Hammond - GHIDRA for Reverse Engineering (PicoCTF 2022 #42 'bbbloat'). Katsottavissa https://www.youtube.com/watch?v=oTD_ki86c9I. 

